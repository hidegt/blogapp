<h1>blog show</h1>
<ul>
  <li>
    <i class="fas fa-user-edit"></i>By <%= link_to @blog.user.name, user_path(@blog.user.id) %>
    <% unless current_user == @blog.user %>
      <% if current_user.following?(@blog.user) %>
        <%= form_for(current_user.relationships.find_by(follow_id: @blog.user.id), html: { method: :delete}) do |f| %>
          <%= hidden_field_tag :follow_id, @blog.user.id %>
          <%= f.submit "Unfollow", class: "btn btn-danger btn-block" %>
        <% end %>
      <% else %>
        <%= form_for(current_user.relationships.build) do |f| %>
          <%= hidden_field_tag :follow_id, @blog.user.id %>
          <%= f.submit "Follow", class: "btn btn-primary btn-block" %>
        <% end %>
      <% end %>
    <% end %>
  </li>
  <li>
    <i class="far fa-calendar-alt"></i><%= @blog.created_at.strftime('%Y/%m/%d') %>
  </li>
</ul>
<h2><%= @blog.title %></h2>
<%= attachment_image_tag @blog, :image %>
<p><%= safe_join(@blog.body.split("\n"),tag(:br)) %></p>
<ul>
  <% if @blog.liked_by?(current_user) %>
    <li>
      <%= link_to blog_likes_path(@blog), method: :delete do %>
        <i class="fas fa-heart" aria-hidden="true" style="color: red;"></i>
      <% end %>
      <%= @blog.likes.count %> likes
    </li>
  <% else %>
    <li>
      <%= link_to blog_likes_path(@blog), method: :post do %>
        <i class="far fa-heart" aria-hidden="true"></i>
      <% end %>
      <%= @blog.likes.count %> likes
    </li>
  <% end %>
  <li>
    <i class="far fa-comments"></i>
    <a href="#comments"><%= @blog.blog_comments.count %></a> comments
  </li>
</ul>

<% if @blog.user == current_user %>
  <ul>
    <li><%= link_to "Edit this blog", edit_blog_path(@blog.id) %></li>
    <li><%= link_to "Delete this blog", blog_path(@blog), method: :delete, "data-confirm" => "Do you want to delete?" %></li>
  </ul>
<% end %>
<%= form_with(model:[@blog,@blog_comment], local:true) do |f| %>
  <%= f.text_area :comment, class: "form-control", placeholder:"comment is here..." %>
  <%= f.submit "send", class: "btn btn-lg btn-base-1 mt-20 pull-right" %>
<% end %>


<h2><%= @blog.blog_comments.count %>comments</h2>
<ol>
  <% @blog.blog_comments.each do |blog_comment| %>
    <li class="comment">
      <%= attachment_image_tag blog_comment.user, :profile_image, :fill, 60, 60, fallback: "no_image.jpg" %>
      <a href="#" class="link-author"><%= blog_comment.user.name %></a>
      <span class="comment-meta">
        <span class="comment-data"><%= blog_comment.created_at.strftime('%Y/%m/%d') %></span>
      </span>
      <p><%= blog_comment.comment %></p>
      <% if blog_comment.user == current_user %>
        <%= link_to "delete", blog_blog_comment_path(blog_comment.blog, blog_comment), method: :delete, class: "btn btn-danger pull right" %>
      <% end %>
    </li>
  <% end %>
</ol>

